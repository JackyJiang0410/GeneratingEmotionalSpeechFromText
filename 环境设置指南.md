# 环境设置指南

## 当前环境状态

你当前没有 `f5` 和 `tortoise` 的 conda 环境。你需要先创建这些环境。

## 创建 F5-TTS 环境

根据 F5-TTS 的文档，创建环境的方法：

### 1. 创建环境（Python 3.11）

```bash
# 创建名为 f5-tts 的环境（或使用 f5，名称可以自定义）
conda create -n f5-tts python=3.11
conda activate f5-tts
```

### 2. 安装 PyTorch（根据你的硬件选择）

**对于 Apple Silicon (Mac M系列芯片)：**
```bash
pip install torch torchaudio
```

**对于 NVIDIA GPU：**
```bash
pip install torch==2.4.0+cu124 torchaudio==2.4.0+cu124 --extra-index-url https://download.pytorch.org/whl/cu124
```

**对于 CPU 或 Intel GPU：**
```bash
pip install torch torchaudio
```

### 3. 安装 F5-TTS

由于模型已经在 `models/F5-TTS/` 目录中，你可以：

```bash
# 进入 F5-TTS 目录
cd /Users/haojiang/Desktop/EE381V/Project/models/F5-TTS

# 安装为可编辑包
pip install -e .
```

或者如果已经安装了 pip 包：
```bash
pip install f5-tts
```

### 4. 验证安装

```bash
python -c "from f5_tts.api import F5TTS; print('F5-TTS installed successfully!')"
```

## 创建 Tortoise-TTS 环境

### 1. 创建环境

```bash
# 创建名为 tortoise-tts 的环境
conda create -n tortoise-tts python=3.10
conda activate tortoise-tts
```

### 2. 安装 PyTorch

**对于 Apple Silicon：**
```bash
pip install torch torchaudio
```

**对于其他平台，请参考 PyTorch 官方文档：**
```bash
# CPU 版本
pip install torch torchaudio

# CUDA 版本（如果有 NVIDIA GPU）
# 请访问 https://pytorch.org/ 获取适合你系统的命令
```

### 3. 安装 Tortoise-TTS

```bash
# 进入 Tortoise-TTS 目录
cd /Users/haojiang/Desktop/EE381V/Project/models/tortoise-tts

# 安装依赖
pip install -r requirements.txt

# 或者如果使用 setup.py
pip install -e .
```

### 4. 验证安装

```bash
python -c "from tortoise.api import TextToSpeech; print('Tortoise-TTS installed successfully!')"
```

## 快速设置脚本

你可以使用以下命令快速创建环境（Mac Apple Silicon 版本）：

### F5-TTS 环境

```bash
# 创建环境
conda create -n f5 python=3.11 -y

# 激活环境
conda activate f5

# 安装 PyTorch（Apple Silicon）
pip install torch torchaudio

# 进入 F5-TTS 目录并安装
cd /Users/haojiang/Desktop/EE381V/Project/models/F5-TTS
pip install -e .

# 返回项目根目录
cd /Users/haojiang/Desktop/EE381V/Project
```

### Tortoise-TTS 环境

```bash
# 创建环境
conda create -n tortoise python=3.10 -y

# 激活环境
conda activate tortoise

# 安装 PyTorch（Apple Silicon）
pip install torch torchaudio

# 进入 Tortoise-TTS 目录并安装依赖
cd /Users/haojiang/Desktop/EE381V/Project/models/tortoise-tts
pip install -r requirements.txt

# 返回项目根目录
cd /Users/haojiang/Desktop/EE381V/Project
```

## 使用方法（环境创建后）

### 运行 F5-TTS 脚本

```bash
conda activate f5  # 或 f5-tts（取决于你创建环境时使用的名称）
cd /Users/haojiang/Desktop/EE381V/Project
python scripts/run_f5_batch.py
```

### 运行 Tortoise-TTS 脚本

```bash
conda activate tortoise  # 或 tortoise-tts（取决于你创建环境时使用的名称）
cd /Users/haojiang/Desktop/EE381V/Project
python scripts/run_tortoise_batch.py
```

## 注意事项

1. **环境名称可以自定义**：脚本中使用 `conda activate f5` 和 `conda activate tortoise`，但如果你创建的环境名称不同，需要相应修改。

2. **Python 版本要求**：
   - F5-TTS: Python >= 3.10（推荐 3.11）
   - Tortoise-TTS: Python 3.10（建议）

3. **如果遇到导入错误**：
   - 确保在正确的 conda 环境中
   - 确保模型目录存在：`models/F5-TTS/` 和 `models/tortoise-tts/`
   - 尝试重新安装依赖

4. **依赖冲突**：如果遇到依赖冲突，建议使用独立的环境（如上所示）。

